如何和浮点数愉快的玩耍
----------
**作者**: [高老师很忙](https://weibo.com/517082456)
最近遇到了一个小数的坑：1*10+3*1+1*0.1+4*0.04 你觉得这个计算出来是多少呢？难道不是13.14么？的确不是，如图1。

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2019/05/3-1.png)

这是由于计算机中浮点数用二进制表示可能会丢失精度，很难准确的表示我们语义上的数值，比如说13.14。感兴趣的小伙伴可以去搜索一下相关知识。知道原理后，该如何去处理这类计算呢，如果在一些特定的场景内，只有2位小数的情况，那么可以运算前乘以100的倍数，然后再除以100，用整数去计算，可以减少误差，如图2。

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2019/05/3-2.png)

当其他小伙伴阅读代码的时候估计会很难理解这样的神操作，况且这些浮点数的计算可能很多情况我们很难去预知有多少位小数，这种情况可以使用`NSDecimalNumber`去计算，如图3，也可以得到我们想要的结果。

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2019/05/3-3.png)


`NSDecimalNumber`的接口并不是很友好，我们可以写一些category或者其他扩展类让上层业务更易用。

如果有更好的玩耍方案，欢迎一起分享讨论。






